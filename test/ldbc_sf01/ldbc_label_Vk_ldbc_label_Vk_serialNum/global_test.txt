//clean up: MATCH (n) WHERE n.ViewName IS NOT NULL REMOVE n.ViewName
//for path views: MATCH (v:View) DETACH DELETE v

MATCH (n:Comment) WHERE n.browserUsed = "Safari" WITH DISTINCT(n) SET n.V1_1 = "n" RETURN n
MATCH (n:Comment) WHERE n.browserUsed = "Internet Explorer" WITH DISTINCT(n) SET n.V1_2 = "n" RETURN n
MATCH (n:Message) WHERE  n.creationDate > 1310000000000 AND n.creationDate < 1313000000000 WITH DISTINCT(n) SET n.V2_1="n" RETURN n
MATCH (n:Message) WHERE  n.creationDate > 1310000000000 AND n.creationDate < 1316000000000 WITH DISTINCT(n) SET n.V2_2="n" RETURN n
MATCH (f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE f.creationDate<1265000000000 WITH DISTINCT(po) SET po.V3_1="po" RETURN po
MATCH (f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" WITH DISTINCT(po) SET po.V3_2="po" RETURN po
MATCH (f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" AND f.title STARTS WITH "Wall" WITH DISTINCT(po)  SET po.V4_1="po" RETURN po
MATCH (f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE po.length > 5 AND po.browserUsed = "Opera" WITH DISTINCT(f) SET f.V4_2="f" RETURN f
MATCH (c:Message)-[:REPLY_OF]->(m:Message) WHERE c.browserUsed = m.browserUsed WITH DISTINCT(c) SET c.V5="c" RETURN c
MATCH (c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed WITH DISTINCT(s)  SET s.V6_1="s" RETURN s
MATCH (c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed AND s.gender = "male" WITH DISTINCT(s) SET s.V6_2="s" RETURN s
MATCH (c:Message)-[:HAS_CREATOR]->(s:Person)-[:KNOWS]-(t:Person)<-[:HAS_CREATOR]-(b:Message) WHERE s.birthday < t.birthday+ 1000000000 AND  s.birthday > t.birthday-1000000000 AND c.creationDate < b.creationDate+10000000000 WITH DISTINCT(b) SET b.V7_2="b" RETURN b

//separate node/edge

MATCH p=(f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE f.creationDate<1265000000000 WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V8_1_p = CASE WHEN n.V8_1_p IS NOT NULL THEN n.V8_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V8_1_p = CASE WHEN rel.V8_1_p IS NOT NULL THEN rel.V8_1_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(f:Forum)-[r:CONTAINER_OF]->(po:Post) WHERE f.creationDate<1265000000000 WITH DISTINCT f,po,r,p SET f.V8_1 = 'f' SET po.V8_1='po' SET r.V8_1='r' RETURN COUNT(DISTINCT p)


MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V8_2_p = CASE WHEN n.V8_2_p IS NOT NULL THEN n.V8_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V8_2_p = CASE WHEN rel.V8_2_p IS NOT NULL THEN rel.V8_2_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(f:Forum)-[r:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" WITH DISTINCT f,po,p,r SET f.V8_2 = 'f' SET po.V8_2='po' SET r.V8_2='r' RETURN COUNT(DISTINCT p)


MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" AND f.title STARTS WITH "Wall" WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V9_1_p = CASE WHEN n.V9_1_p IS NOT NULL THEN n.V9_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V9_1_p = CASE WHEN rel.V9_1_p IS NOT NULL THEN rel.V9_1_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(f:Forum)-[r:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" AND f.title STARTS WITH "Wall" WITH DISTINCT f,po,p,r SET f.V9_1 = 'f' SET po.V9_1='po' SET r.V9_1='r'  RETURN COUNT(DISTINCT p)


MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.length > 5 AND po.browserUsed = "Opera" WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V9_2_p = CASE WHEN n.V9_2_p IS NOT NULL THEN n.V9_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V9_2_p = CASE WHEN rel.V9_2_p IS NOT NULL THEN rel.V9_2_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(f:Forum)-[r:CONTAINER_OF]->(po:Post) WHERE po.length > 5 AND po.browserUsed = "Opera" WITH DISTINCT f,po,r,p SET f.V9_2 = 'f' SET po.V9_2='po' SET r.V9_2='r'  RETURN COUNT(DISTINCT p)

MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message) WHERE c.browserUsed = m.browserUsed WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V10_p = CASE WHEN n.V10_p IS NOT NULL THEN n.V10_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V10_p = CASE WHEN rel.V10_p IS NOT NULL THEN rel.V10_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message) WHERE c.browserUsed = m.browserUsed WITH DISTINCT c,m,r1,p SET c.V10 = 'c' SET m.V10='m' SET r1.V10='r1' RETURN COUNT(DISTINCT p)

MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos])[0] AS firstR,relationships(allP1[pos])[1] AS secondR SET n.V11_1_p = CASE WHEN n.V11_1_p IS NOT NULL THEN n.V11_1_p +pos ELSE [pos] END WITH firstR,secondR,pos SET firstR.V11_1_p = CASE WHEN firstR.V11_1_p IS NOT NULL THEN firstR.V11_1_p +pos+".0," ELSE pos+".0," END SET secondR.V11_1_p = CASE WHEN secondR.V11_1_p IS NOT NULL THEN secondR.V11_1_p +pos+".1," ELSE pos+".1," END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed WITH DISTINCT c,m,s,r1,r2,p SET c.V11_1 = 'c' SET m.V11_1='m' SET s.V11_1='s' SET r1.V11_1='r1' SET r2.V11_1='r2' RETURN COUNT(DISTINCT p)


MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed AND s.gender = "male" WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V11_2_p = CASE WHEN n.V11_2_p IS NOT NULL THEN n.V11_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V11_2_p = CASE WHEN rel.V11_2_p IS NOT NULL THEN rel.V11_2_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed AND s.gender = "male" WITH DISTINCT c,m,s,r1,r2,p SET c.V11_2 = 'c' SET m.V11_2='m' SET s.V11_2='s' SET r1.V11_2='r1' SET r2.V11_2='r2' RETURN COUNT(DISTINCT p)


MATCH p=(c:Message)-[r1:HAS_CREATOR]->(s:Person)-[r2:KNOWS]-(t:Person)<-[r3:HAS_CREATOR]-(b:Message) WHERE s.birthday < t.birthday+ 1000000000 AND  s.birthday > t.birthday-1000000000 AND c.creationDate < b.creationDate+10000000000 WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V12_2_p = CASE WHEN n.V12_2_p IS NOT NULL THEN n.V12_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V12_2_p = CASE WHEN rel.V12_2_p IS NOT NULL THEN rel.V12_2_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:HAS_CREATOR]->(s:Person)-[r2:KNOWS]-(t:Person)<-[r3:HAS_CREATOR]-(b:Message) WHERE s.birthday < t.birthday+ 1000000000 AND  s.birthday > t.birthday-1000000000 AND c.creationDate < b.creationDate+10000000000  WITH DISTINCT c,s,t,b,r1,r2,r3,p SET c.V12_2 = 'c' SET t.V12_2='t' SET s.V12_2='s' SET b.V12_2='b' SET r1.V12_2='r1' SET r2.V12_2='r2' SET r3.V12_2='r3' RETURN COUNT(DISTINCT p)


MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  s.gender='male' WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V14_1_p = CASE WHEN n.V14_1_p IS NOT NULL THEN n.V14_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V14_1_p = CASE WHEN rel.V14_1_p IS NOT NULL THEN rel.V14_1_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  s.gender='male' WITH DISTINCT c,m,s,r1,r2,r3,p SET c.V14_1 = 'c' SET m.V14_1='m' SET s.V14_1='s' SET r1.V14_1='r1' SET r2.V14_1='r2' SET r3.V14_1='r3' RETURN COUNT(DISTINCT p)


MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  m.browserUsed='Safari' OR m.browserUsed='Internet Explorer' WITH COLLECT(DISTINCT(p)) as allP1 UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList SET n.V14_2_p = CASE WHEN n.V14_2_p IS NOT NULL THEN n.V14_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V14_2_p = CASE WHEN rel.V14_2_p IS NOT NULL THEN rel.V14_2_p +pos ELSE pos END RETURN MAX(pos)
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  m.browserUsed='Safari' OR m.browserUsed='Internet Explorer' WITH DISTINCT c,m,s,r1,r2,r3,p SET c.V14_2 = 'c' SET m.V14_2='m' SET s.V14_2='s' SET r1.V14_2='r1' SET r2.V14_2='r2' SET r3.V14_2='r3'  RETURN COUNT(DISTINCT p)

//all in one
MATCH p=(f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE f.creationDate<1265000000000 WITH COLLECT(DISTINCT(p)) as allP1,f,po UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,f,po,relationships(allP1[pos]) AS relList  SET f.V8_1 = 'f' SET po.V8_1='po' SET n.V8_1_p = CASE WHEN n.V8_1_p IS NOT NULL THEN n.V8_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V8_1_p = CASE WHEN rel.V8_1_p IS NOT NULL THEN rel.V8_1_p +pos ELSE pos END RETURN pos
MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" WITH COLLECT(DISTINCT(p)) as allP1,f,po UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,f,po SET f.V8_2 = 'f' SET po.V8_2='po' SET n.V8_2_p = CASE WHEN n.V8_2_p IS NOT NULL THEN n.V8_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V8_2_p = CASE WHEN rel.V8_2_p IS NOT NULL THEN rel.V8_2_p +pos ELSE pos END RETURN pos
MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" AND f.title STARTS WITH "Wall" WITH COLLECT(DISTINCT(p)) as allP1,f,po UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,f,po SET f.V9_1 = 'f' SET po.V9_1='po' SET n.V9_1_p = CASE WHEN n.V9_1_p IS NOT NULL THEN n.V9_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V9_1_p = CASE WHEN rel.V9_1_p IS NOT NULL THEN rel.V9_1_p +pos ELSE pos END RETURN pos
MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.length > 5 AND po.browserUsed = "Opera" WITH COLLECT(DISTINCT(p)) as allP1,f,po UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,f,po SET f.V9_2 = 'f' SET po.V9_2='po' SET n.V9_2_p = CASE WHEN n.V9_2_p IS NOT NULL THEN n.V9_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V9_2_p = CASE WHEN rel.V9_2_p IS NOT NULL THEN rel.V9_2_p +pos ELSE pos END RETURN pos
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message) WHERE c.browserUsed = m.browserUsed WITH COLLECT(DISTINCT(p)) as allP1,c,m UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,c,m SET c.V10 = 'c' SET m.V10='m' SET n.V10_p = CASE WHEN n.V10_p IS NOT NULL THEN n.V10_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V10_p = CASE WHEN rel.V10_p IS NOT NULL THEN rel.V10_p +pos ELSE pos END RETURN pos
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed WITH COLLECT(DISTINCT(p)) as allP1,c,m,s UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos])[0] AS firstR,relationships(allP1[pos])[1] AS secondR,c,m,s SET c.V11_1 = 'c' SET m.V11_1='m' SET s.V11_1='s' SET n.V11_1_p = CASE WHEN n.V11_1_p IS NOT NULL THEN n.V11_1_p +pos ELSE pos END WITH firstR,secondR,pos SET firstR.V11_1_p = CASE WHEN firstR.V11_1_p IS NOT NULL THEN firstR.V11_1_p +"pos.0," ELSE "pos.0," END SET secondR.V11_1_p = CASE WHEN secondR.V11_1_p IS NOT NULL THEN secondR.V11_1_p +"pos.1," ELSE "pos.1," END RETURN pos
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed AND s.gender = "male" WITH COLLECT(DISTINCT(p)) as allP1,c,m,s UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,c,m,s SET c.V11_2 = 'c' SET m.V11_2='m' SET s.V11_2='s' SET n.V11_2_p = CASE WHEN n.V11_2_p IS NOT NULL THEN n.V11_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V11_2_p = CASE WHEN rel.V11_2_p IS NOT NULL THEN rel.V11_2_p +pos ELSE pos END RETURN pos
MATCH p=(c:Message)-[r1:HAS_CREATOR]->(s:Person)-[r2:KNOWS]-(t:Person)<-[r3:HAS_CREATOR]-(b:Message) WHERE s.birthday < t.birthday+ 1000000000 AND  s.birthday > t.birthday-1000000000 AND c.creationDate < b.creationDate+10000000000 WITH COLLECT(DISTINCT(p)) as allP1,c,s,t,b UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,c,s,t,b SET c.V12_2 = 'c' SET t.V12_2='t' SET s.V12_2='s' SET b.V12_2='b' SET n.V12_2_p = CASE WHEN n.V12_2_p IS NOT NULL THEN n.V12_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V12_2_p = CASE WHEN rel.V12_2_p IS NOT NULL THEN rel.V12_2_p +pos ELSE pos END RETURN pos
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  s.gender='male' WITH COLLECT(DISTINCT(p)) as allP1,c,m,s UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,c,m,s SET c.V14_1 = 'c' SET m.V14_1='m' SET s.V14_1='s' SET n.V14_1_p = CASE WHEN n.V14_1_p IS NOT NULL THEN n.V14_1_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V14_1_p = CASE WHEN rel.V14_1_p IS NOT NULL THEN rel.V14_1_p +pos ELSE pos END RETURN pos
MATCH p=(c:Message)-[r1:REPLY_OF]->(m:Message)<-[r2:LIKES]-(s:Person)<-[r3:HAS_CREATOR]-(c) WHERE  m.browserUsed='Safari' OR m.browserUsed='Internet Explorer' WITH COLLECT(DISTINCT(p)) as allP1,c,m,s UNWIND RANGE(0,SIZE(allP1)-1) as pos WITH pos,nodes(allP1[pos])[0] as n,relationships(allP1[pos]) AS relList,c,m,s SET c.V14_2 = 'c' SET m.V14_2='m' SET s.V14_2='s' SET n.V14_2_p = CASE WHEN n.V14_2_p IS NOT NULL THEN n.V14_2_p +pos ELSE pos END WITH relList,pos UNWIND relList as rel SET rel.V14_2_p = CASE WHEN rel.V14_2_p IS NOT NULL THEN rel.V14_2_p +pos ELSE pos END RETURN pos



MATCH p=(f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE f.creationDate<1265000000000 WITH DISTINCT p,f,po SET f.V18_1 = 'f' SET po.V18_1='po' RETURN COUNT(DISTINCT f)
MATCH p=(f:Forum)-[r1:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" WITH DISTINCT f,po SET f.V18_2 = 'f' SET po.V18_2='po' RETURN COUNT(DISTINCT f)
MATCH p=(f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE po.language = "ar" AND f.title STARTS WITH "Wall"  WITH DISTINCT f,po SET f.V19_1 = 'f' SET po.V19_1='po' RETURN COUNT(DISTINCT f)
MATCH p=(f:Forum)-[:CONTAINER_OF]->(po:Post) WHERE po.length > 5 AND po.browserUsed = "Opera"  WITH DISTINCT f,po SET f.V19_2 = 'f' SET po.V19_2='po' RETURN COUNT(DISTINCT f)
MATCH p=(c:Message)-[:REPLY_OF]->(m:Message) WHERE c.browserUsed = m.browserUsed WITH DISTINCT c,m SET c.V20 = 'c' SET m.V20='m' RETURN COUNT(DISTINCT c)
MATCH p=(c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed WITH DISTINCT c,m,s SET c.V21_1 = 'c' SET m.V21_1='m' SET s.V21_1='s' RETURN COUNT(DISTINCT c)
MATCH p=(c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person) WHERE c.browserUsed = m.browserUsed AND s.gender = "male" WITH DISTINCT p,c,m,s SET c.V21_2 = 'c' SET m.V21_2='m' SET s.V21_2='s' RETURN COUNT(DISTINCT p)
MATCH p=(c:Message)-[:HAS_CREATOR]->(s:Person)-[:KNOWS]-(t:Person)<-[:HAS_CREATOR]-(b:Message) WHERE s.birthday < t.birthday+ 1000000000 AND  s.birthday > t.birthday-1000000000 AND c.creationDate < b.creationDate+10000000000 WITH DISTINCT c,s,t,b SET c.V22_2 = 'c' SET t.V22_2='t' SET s.V22_2='s' SET b.V22_2='b' RETURN COUNT(c)
MATCH p=(c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person)<-[:HAS_CREATOR]-(c) WHERE  s.gender='male' WITH DISTINCT c,m,s SET c.V24_1 = 'c' SET m.V24_1='m' SET s.V24_1='s' RETURN COUNT(DISTINCT c)
MATCH p=(c:Message)-[:REPLY_OF]->(m:Message)<-[:LIKES]-(s:Person)<-[:HAS_CREATOR]-(c) WHERE m.browserUsed='Safari' OR m.browserUsed='Internet Explorer' WITH DISTINCT c,m,s SET c.V24_2 = 'c' SET m.V24_2='m' SET s.V24_2='s' RETURN COUNT(DISTINCT c)


//usage
MATCH (n:Message)<-[:LIKES]-(p:Person) WHERE n.V2_2="n" RETURN DISTINCT p
MATCH (f:Forum)-[:CONTAINER_OF]->(po:Post)-[:HAS_CREATOR]->(s:Person) WHERE po.V3_2="po" AND s.V6_2="s" RETURN DISTINCT f
MATCH (f:Forum)-[:HAS_MODERATOR]->(s:Person) WHERE f.V9_1="f" RETURN DISTINCT s
MATCH (n:Message)-[:HAS_CREATOR]->(s:Person)<-[:HAS_MODERATOR]-(f:Forum)-[:CONTAINER_OF]->(m:Message) WHERE n.V5="c" AND m.V7_2="b" RETURN DISTINCT s
MATCH (s:Person)<-[:HAS_CREATOR]-(m:Message) WHERE m.V11_2="m" OR m.V11_2="c" RETURN DISTINCT s


CREATE TEXT INDEX v1 FOR (n:Message) on n.V2_2
CREATE TEXT INDEX v2 FOR (n:Post) on n.V3_2
CREATE TEXT INDEX v3 FOR (n:Person) on n.V6_2
CREATE TEXT INDEX v4 FOR (n:Forum) on n.V9_1
CREATE TEXT INDEX v5 FOR (n:Message) on n.V5
CREATE TEXT INDEX v7 FOR (n:Message) on n.V7_2
CREATE TEXT INDEX v8 FOR (n:Message) on n.V11_2


MATCH (n) WHERE n.V1_1 IS NOT NULL REMOVE n.V1_1
MATCH (n) WHERE n.V1_2 IS NOT NULL REMOVE n.V1_2
MATCH (n) WHERE n.V2_1 IS NOT NULL REMOVE n.V2_1
MATCH (n) WHERE n.V2_2 IS NOT NULL REMOVE n.V2_2
MATCH (n) WHERE n.V3_1 IS NOT NULL REMOVE n.V3_1
MATCH (n) WHERE n.V3_2 IS NOT NULL REMOVE n.V3_2
MATCH (n) WHERE n.V4_1 IS NOT NULL REMOVE n.V4_1
MATCH (n) WHERE n.V4_2 IS NOT NULL REMOVE n.V4_2
MATCH (n) WHERE n.V5 IS NOT NULL REMOVE n.V5
MATCH (n) WHERE n.V6_1 IS NOT NULL REMOVE n.V6_1
MATCH (n) WHERE n.V6_2 IS NOT NULL REMOVE n.V6_2
MATCH (n) WHERE n.V7_2 IS NOT NULL REMOVE n.V7_2
MATCH (n) WHERE n.V8_1 IS NOT NULL REMOVE n.V8_1
MATCH (n) WHERE n.V8_2 IS NOT NULL REMOVE n.V8_2
MATCH (n) WHERE n.V9_1 IS NOT NULL REMOVE n.V9_1
MATCH (n) WHERE n.V9_2 IS NOT NULL REMOVE n.V9_2
MATCH (n) WHERE n.V10 IS NOT NULL REMOVE n.V10
MATCH (n) WHERE n.V11_1 IS NOT NULL REMOVE n.V11_1
MATCH (n) WHERE n.V11_2 IS NOT NULL REMOVE n.V11_2
MATCH (n) WHERE n.V12_2 IS NOT NULL REMOVE n.V12_2
MATCH (n) WHERE n.V14_1 IS NOT NULL REMOVE n.V14_1
MATCH (n) WHERE n.V14_2 IS NOT NULL REMOVE n.V14_2

WITH VIEWS V11_1 LOCAL MATCH p=* RETURN p:
MATCH (n) WHERE n.V11_1_p IS NOT NULL UNWIND n.V11_1_p AS pos MATCH p=(n)-[r1]-()-[r2]-() WHERE r1.V11_1_p CONTAINS pos+".0" AND r2.V11_1_p CONTAINS pos+".1" return COUNT(DISTINCT p) 
